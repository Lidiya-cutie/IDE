# Библиотека requests

С помощью скрипта мы будем в удобном виде выгружать информацию по курсам валют с заранее выбранного сайта.

Перед началом работы библиотеку *requests* потребуется установить. Например, в *Jupyter Notebook* это делается с помощью такой команды:

```python
# Устанавливаем библиотеку requests
!pip install requests
```
Как только библиотека установлена, импортируем её и отправим наш первый запрос к ресурсу [Курсы валют ЦБ РФ в XML и JSON](https://www.cbr-xml-daily.ru/). Используем метод *get()* из библиотеки requests, передав ему соответствующий *URL —  https://www.cbr-xml-daily.ru/daily_json.js*:

```python
# Импортируем библиотеку requests
import requests
# Определяем значение URL страницы для запроса
url = 'https://www.cbr-xml-daily.ru/daily_json.js'
# Делаем GET-запрос к ресурсу и результат ответа сохраняем в переменной response
response = requests.get(url)

# Проверим ответ сервера — содержимое переменной response:
# Выводим значение response на экран как объект
print(response)

# <Response [200]> - результат вывода кода 
```

Мы получили объект ответа *Response*, который содержит всю нужную нам информацию. По умолчанию в квадратных скобках на экран выводится код статуса ответа. В данном случае он равен 200 — то есть запрос был корректным и сервер отдал нам нужную информацию. Значение кода статуса 404 означало бы, что страница по указанному адресу не найдена, а значение 403 — что синтаксис *GET*-запроса неверный.

Код ответа в виде числовой переменной можно получить с помощью метода *status_code*:
```python
# Выводим числовое значение response на экран
print(response.status_code)
```
Мы сделали запрос и получили корректный ответ (код статуса — 200). Дальнейшую работу производим с результатом запроса к ресурсу Курсы валют *ЦБ РФ* в *XML* и *JSON*.

Текст ответа хранится в атрибуте *text*. Выведем значение атрибута на экран и посмотрим на его содержимое:
```python
# Выводим содержимое атрибута text переменной response на экран
print(response.text)
```
Для того чтобы удобно было работать с полученной информацией, нам необходимо преобразовать строку в словарь. В объект ответа Response  из библиотеки requests уже встроен метод *json()*.

Импортируем функцию *pprint()*, применим к полученному ответу метод *json()* и выведем полученный результат на экран:
```python
# Импортируем функцию pprint()
from pprint import pprint
# Применяем метод json()
currencies = response.json()
# Выводим результат на экран)
pprint(currencies)
```
Теперь данные находятся в словаре и можно легко получать необходимые значения.

Например, по ключу *Valute* мы можем обратиться к вложенному словарю, который содержит информацию о мировых валютах. Выведем на экран, например, информацию о евро (*EUR*):
```python
# Выводим на экран информацию о валюте евро
pprint(currencies['Valute']['EUR'])
print(currencies['Valute']['CZK']['Name'])
```

```python
# Выводим на экран информацию о валюте 
print(currencies['Valute']['CZK']['Name'])
# Чешских крон - результат работы кода
```
